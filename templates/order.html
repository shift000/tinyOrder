<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Dashboard</title>
    <!-- CSS files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tabler.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tabler-flags.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tabler-payments.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tabler-vendors.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/demo.min.css') }}">
</head>
  <body >
    <script src="{{ url_for('static', filename='js/demo-theme.min.js') }}"></script>
    <div class="page">
      <!-- Navbar -->
      <header class="navbar navbar-expand-md d-print-none" >
        <div class="container-xl">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <h1 class="navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3">
            <a href=".">
              <img src="" width="110" height="32" alt="{{ config.headline }}" class="navbar-brand-image">
			  <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-baguette"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5.628 11.283l5.644 -5.637c2.665 -2.663 5.924 -3.747 8.663 -1.205l.188 .181a2.987 2.987 0 0 1 0 4.228l-11.287 11.274a3 3 0 0 1 -4.089 .135l-.143 -.135c-2.728 -2.724 -1.704 -6.117 1.024 -8.841z" /><path d="M9.5 7.5l1.5 3.5" /><path d="M6.5 10.5l1.5 3.5" /><path d="M12.5 4.5l1.5 3.5" /></svg>
            </a>
          </h1>
          <div class="navbar-nav flex-row order-md-last">
            <div class="d-none d-md-flex">
              <a href="?theme=dark" class="nav-link px-0 hide-theme-dark" title="ENABLE_DARK" data-bs-toggle="tooltip"
		   data-bs-placement="bottom">
                <!-- Download SVG icon from http://tabler-icons.io/i/moon -->
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" /></svg>
              </a>
              <a href="?theme=light" class="nav-link px-0 hide-theme-light" title="ENABLE_LIGHT" data-bs-toggle="tooltip"
		   data-bs-placement="bottom">
                <!-- Download SVG icon from http://tabler-icons.io/i/sun -->
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" /><path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7" /></svg>
              </a>
              <div class="nav-item dropdown d-none d-md-flex me-3">
                <a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1" aria-label="SHOW_NOTI">
                  <!-- Download SVG icon from http://tabler-icons.io/i/bell -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 5a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6" /><path d="M9 17v1a3 3 0 0 0 6 0v-1" /></svg>
                  <span class="badge bg-red"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-end dropdown-menu-card">
                  <div class="card">
                    <div class="card-header">
                      <h3 class="card-title">{{ config.last_updates }}</h3>
                    </div>
                    <div class="list-group list-group-flush list-group-hoverable">
                      {% for new in news %}
                      <div class="list-group-item">
                        <div class="row align-items-center">
                          <div class="col-auto">
                              {% if new.status_bad %}
                                  <span class="status-dot status-dot-animated bg-red d-block"></span>
                              {% elif new.status_good %}
                                  <span class="status-dot status-dot-animated bg-green d-block"></span>
                              {% else %}
                                  <span class="status-dot d-block"></span>
                              {% endif %}
                            </div>
                          <div class="col text-truncate">
                            <a href="#" class="text-body d-block">{{ new.title }}</a>
                            <div class="d-block text-muted text-truncate mt-n1">
                              {{ new.message }}
                            </div>
                          </div>
                          <div class="col-auto">
                            <a href="#" class="list-group-item-actions">
                              <!-- Download SVG icon from http://tabler-icons.io/i/star -->
                              <svg xmlns="http://www.w3.org/2000/svg" class="icon text-muted" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z" /></svg>
                            </a>
                          </div>
                        </div>
                      </div>
                        {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="nav-item dropdown">
              <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                <span class="avatar avatar-sm" style="background-image: url({{ url_for('static', filename='img/026m.jpg') }})"></span>
                <div class="d-none d-xl-block ps-2">
                  <div>{{ username }}</div>
                  <div class="mt-1 small text-muted">{{ email }}</div>
                </div>
              </a>
              <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <a href="/profile" class="dropdown-item">{{ config.btn_profile }}</a>
                <a href="/feedback" class="dropdown-item">{{ config.btn_feedback }}</a>
                <div class="dropdown-divider"></div>
                <a href="/accounts" class="dropdown-item">{{ config.btn_accounts }}</a>
                <a href="/logout" class="dropdown-item">{{ config.btn_logout }}</a>
              </div>
            </div>
          </div>
        </div>
      </header>
      <header class="navbar-expand-md">
        <div class="collapse navbar-collapse" id="navbar-menu">
          <div class="navbar">
            <div class="container-xl">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="./" >
                    <span class="nav-link-icon d-md-none d-lg-inline-block"><!-- Download SVG icon from http://tabler-icons.io/i/home -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l-2 0l9 -9l9 9l-2 0" /><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" /><path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" /></svg>
                    </span>
                    <span class="nav-link-title">
                      {{ config.link_index }}
                    </span>
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="page-wrapper">
        <!-- Page header -->
        <div class="page-header d-print-none">
          <div class="container-xl">
				<div class="col-md-12">
					<div class="row row-cards">
						{% if config.notification %}
							<div class="col-12">
								<button class="btn position-relative" style="pointer-events: none;">Information: {{ config.notification }}<span class="badge bg-red badge-notification badge-pill">!</span></button>
							</div>
						{% endif %}
						<div class="col-8">
							<form class="card" method="POST" action="{{ url_for('make_order') }}">
								<div class="card-body">
									<h3 class="card-title">{{ config.od_title }}</h3>
									<div class="row row-cards">
										<div class="col-md-12">
											<div class="mb-3 mb-0">
												<p>{{ config.od_desc }}</p>
											</div>
		
											<!-- Dynamically added input rows will be inside this container -->
											<div id="inputContainer">
												<div class="mb-3 row input-row">
													<div class="col-md-5">
													<!-- Anzahl Input (fills the left side of the row fully) -->
														<input name="anzahl[]" type="number" class="form-control" style="margin: 0; width: 100%;" min="1" max="3" value="1" placeholder="Anzahl">
													</div>

													<div class="col-md-5">
													<!-- Ware Select Dropdown -->
														<select name="ware[]" class="form-select" aria-label="Floating label select example">
														{% for entry in entries %}
															<option value="{{ entry.iid }}">{{ entry.name }}</option>
														{% endfor %}
														</select>
													</div>

													<div class="col-md-2">
													<!-- Remove button -->
														<a href="#" class="removeRow btn-square w-100 btn btn-danger">{{ config.btn_remove_row }}</a>
													</div>
												</div>
											</div>
											<div id="error-message" style="color: red; display: none;"></div>
										</div>

										<!-- Extra comment section -->
										<div class="col-md-12">
											<div class="mb-3 mb-0">
												<label class="form-label">{{ config.od_extra_title }}</label>
												<textarea name="extra" rows="5" class="form-control" placeholder="{{ config.od_extra_placeholder }}" style="overflow: hidden; overflow-wrap: break-word; resize: none; text-align: start; height: 150px;"></textarea>
											</div>
										</div>
									</div>
								</div>

								<!-- Submit button -->
								<div class="card-footer text-end">
									<button type="button" class="btn btn-success btn-square" id="addRow">{{ config.btn_add_row }}</button>
									<button type="submit" class="btn btn-white btn-square">{{ config.fb_card_submit }}</button>
								</div>
							</form>
						</div>
						<div class="col-4">
							<form class="card">
								<div class="card-body">
									<h3 class="card-title">{{ config.od_checkout }}</h3>
									<div class="row row-cards">
										<div class="col-md-12">
											<div class="mb-3 mb-0">
												<p>{{ config.od_checkout_list }}</p>
											</div>
										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
        </div>
        <footer class="footer footer-transparent d-print-none">
          <div class="container-xl">
            <div class="row text-center align-items-center flex-row-reverse">
              <div class="col-12 col-lg-auto mt-3 mt-lg-0">
                <ul class="list-inline list-inline-dots mb-0">
                  <li class="list-inline-item">
                    {{ config.copy_copy }}
                    <a href="." class="link-secondary">{{ config.copy_author }}</a>.
                    All rights reserved.
                  </li>
                  <li class="list-inline-item">
                    <a href="./changelog.html" class="link-secondary" rel="noopener">
                      {{ config.copy_version }}
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </footer>
      </div>
    </div>
    <!-- Libs JS -->
    <!-- Tabler Core -->
    <script src="{{ url_for('static', filename='js/tabler.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/demo.min.js') }}"></script>
		
	<script>
		// Fehlernachricht-Container
		var errorMessageDiv = document.getElementById('error-message');
		let maxRows = 6;

		// Event-Listener für die "Zeile hinzufügen"-Schaltfläche
		document.getElementById('addRow').addEventListener('click', function(event) {
		var rowCount = document.getElementById('inputContainer').getElementsByClassName('input-row').length;

		event.preventDefault(); // Verhindert das Standard-Verhalten des Links

		if (rowCount < maxRows) {
			// Container, in den die Zeilen eingefügt werden
			var inputContainer = document.getElementById('inputContainer');
			var lastRow = inputContainer.getElementsByClassName('input-row')[rowCount - 1];
        
			// Variablen für select und input default values
			var defaultWareOption = '<option value="default">Standard Ware</option>';
			var defaultAnzahlValue = 1;

			// Neue Zeile erstellen
			var newRow = document.createElement('div');
			newRow.classList.add('mb-3', 'row', 'input-row');

			// Überprüfen, ob eine vorherige Zeile vorhanden ist
			if (lastRow) {
				var lastSelect = lastRow.querySelector('select');

				// Erstelle das neue <select>-Element und kopiere die Optionen aus der vorherigen Zeile
				var newSelect = document.createElement('select');
				newSelect.name = 'ware[]';
				newSelect.classList.add('form-select');
				newSelect.style.width = '100%';
            
				// Optionen vom letzten <select> in das neue <select> kopieren
				Array.from(lastSelect.options).forEach(function(option) {
					var newOption = document.createElement('option');
					newOption.value = option.value;
					newOption.text = option.text;
					newSelect.appendChild(newOption);
				});
			} else {
				// Falls keine vorherige Zeile existiert, wird das Select-Element mit einem Standardwert erstellt
				var newSelect = document.createElement('select');
				newSelect.name = 'ware[]';
				newSelect.classList.add('form-select');
				newSelect.style.width = '100%';
				newSelect.innerHTML = defaultWareOption;
			}
	
			// HTML für die neue Zeile erstellen und das neue <select> Element einfügen
			newRow.innerHTML = 
				"<div class='col-md-5'>" +
					"<input type='number' name='anzahl[]' min='1' max='3' value='" + defaultAnzahlValue + "' class='form-control' placeholder='Anzahl' style='width: 100%;'>" +
				"</div>" +
				"<div class='col-md-5'></div>" +
				"<div class='col-md-2'>" +
					"<a href='#' class='btn btn-danger removeRow'>Entfernen</a>" +
				"</div>";

			// Füge das neue <select> in die zweite Spalte der neuen Zeile ein
			newRow.querySelector('.col-md-5:nth-child(2)').appendChild(newSelect);
	
			// Neue Zeile zum Container hinzufügen
			inputContainer.appendChild(newRow);

			// Remove-Button-Event-Listener hinzufügen
			addRemoveFunctionality(newRow);

			// Fehlernachricht ausblenden, falls sie sichtbar ist
			errorMessageDiv.style.display = 'none';
		} else {
			// Max-Zeilen-Fehlermeldung anzeigen
			var errorCode = this.getAttribute('data-error');
			errorMessageDiv.textContent = 'Fehlercode: ' + errorCode + ' - Es können maximal ' + maxRows + ' Zeilen hinzugefügt werden.';
			errorMessageDiv.style.display = 'block'; // Fehlernachricht sichtbar machen
		}
	});

	// Funktion, um eine Zeile zu entfernen
	function addRemoveFunctionality(row) {
		row.querySelector('.removeRow').addEventListener('click', function(event) {
			event.preventDefault(); // Verhindert das Standard-Verhalten des Links
        
			var rowCount = document.getElementById('inputContainer').getElementsByClassName('input-row').length;

			if (rowCount > 1) { // Überprüfen, ob mehr als eine Zeile vorhanden ist
				row.remove(); // Entfernt die Zeile
				errorMessageDiv.style.display = 'none'; // Versteckt die Fehlermeldung, falls sie zuvor angezeigt wurde
			} else {
				// Zeige die Fehlermeldung an, dass die letzte Zeile nicht entfernt werden kann
				errorMessageDiv.textContent = "Letzte Zeile kann nicht entfernt werden!";
				errorMessageDiv.style.display = 'block'; // Fehlernachricht sichtbar machen
			}
		});
	}

	// Initiale Remove-Funktion für bestehende Zeilen hinzufügen
	document.querySelectorAll('.removeRow').forEach(function(element) {
		addRemoveFunctionality(element.closest('.input-row'));
	});

	</script>
  </body>
</html>